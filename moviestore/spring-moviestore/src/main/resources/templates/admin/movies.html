<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Movies</title><link rel="stylesheet" href="/css/app.css">
</head>
<body>
<div th:replace="~{fragments/header :: siteHeader}"></div>
<main class="container">
  <h1>Movies</h1>
  <div th:if="${error}" class="alert error">
    <strong>Error:</strong> <span th:text="${error}"></span>
  </div>
  <div th:if="${success}" class="alert success">
    <strong>Success:</strong> <span th:text="${success}"></span>
  </div>
  <form method="post" action="/admin/movies" class="form grid-2">
    <input name="title" placeholder="Title" required>
    <input name="language" placeholder="Language" required>
    <input name="genre" placeholder="Genre" required>
    <input name="director" placeholder="Director" required>
    <input name="cast" placeholder="Cast" required>
    <input name="duration" type="number" placeholder="Duration" required>
    <input name="releaseDate" type="date" required>
    <input name="endDate" type="date" required>
    <textarea name="description" placeholder="Description" required></textarea>
    <button class="btn" type="submit">Add Movie</button>
  </form>
  <table class="table"><thead><tr><th>Poster</th><th>Title</th><th>Genre</th><th>Dates</th><th>Image</th><th></th></tr></thead><tbody>
  <tr th:each="movie : ${movies}">
    <td>
      <img th:if="${movie.image}" th:src="${movie.image}" class="table-image" alt="poster"/>
      <span th:unless="${movie.image}">No image</span>
    </td>
    <td th:text="${movie.title}"></td>
    <td th:text="${movie.genre}"></td>
    <td><span th:text="${movie.releaseDate}"></span> - <span th:text="${movie.endDate}"></span></td>
    <td>
      <form method="post" th:action="@{/admin/movies/{id}/image(id=${movie.id})}" enctype="multipart/form-data" class="inline-form">
        <input type="file" name="file" accept="image/*" required>
        <button class="btn secondary" type="submit">Upload</button>
      </form>
    </td>
    <td><form method="post" th:action="@{/admin/movies/{id}/delete(id=${movie.id})}"><button class="btn danger" type="submit">Delete</button></form></td>
  </tr>
  </tbody></table>
</main>
<div th:replace="~{fragments/footer :: siteFooter}"></div>
</body>
</html>
